

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BTC_03_QPE.QPE &mdash; NEASQC documentation  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
      <link rel="stylesheet" type="text/css" href="_static/contentui.css" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/contentui.js"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="BTC_04_PH: Parent Hamiltonian" href="tnbs.BTC_04_PH.html" />
    <link rel="prev" title="BTC_03_QPE: Quantum Phase Estimation" href="tnbs.BTC_03_QPE.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            NEASQC documentation
              <img src="_static/logo-neasqc.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="tnbs.html">Benchmark Test Cases</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tnbs.BTC_01_PL.html">BTC_01_PL: Probability Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="tnbs.BTC_02_AE.html">BTC_02_AE Amplitude Estimation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="tnbs.BTC_03_QPE.html">BTC_03_QPE: Quantum Phase Estimation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tnbs.BTC_03_QPE.html#module-tnbs.BTC_03_QPE.my_benchmark_execution">my_benchmark_execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="tnbs.BTC_03_QPE.html#module-tnbs.BTC_03_QPE.my_benchmark_info">my_benchmark_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="tnbs.BTC_03_QPE.html#module-tnbs.BTC_03_QPE.my_benchmark_summary">my_benchmark_summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="tnbs.BTC_03_QPE.html#module-tnbs.BTC_03_QPE.my_environment_info">my_environment_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="tnbs.BTC_03_QPE.html#module-tnbs.BTC_03_QPE.neasqc_benchmark">neasqc_benchmark</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="tnbs.BTC_03_QPE.html#subpackage-qpe">Subpackage QPE</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">BTC_03_QPE.QPE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tnbs.BTC_04_PH.html">BTC_04_PH: Parent Hamiltonian</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NEASQC documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="tnbs.html">Benchmark Test Cases</a></li>
          <li class="breadcrumb-item"><a href="tnbs.BTC_03_QPE.html">BTC_03_QPE: Quantum Phase Estimation</a></li>
      <li class="breadcrumb-item active">BTC_03_QPE.QPE</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="btc-03-qpe-qpe">
<h1>BTC_03_QPE.QPE<a class="headerlink" href="#btc-03-qpe-qpe" title="Link to this heading"></a></h1>
<section id="module-tnbs.BTC_03_QPE.QPE.qpe_rz">
<span id="qpe-qpe-rz"></span><h2>QPE.qpe_rz<a class="headerlink" href="#module-tnbs.BTC_03_QPE.QPE.qpe_rz" title="Link to this heading"></a></h2>
<p>Class for executing QPE on a R_z^n operator</p>
<p>Author: Gonzalo Ferro</p>
<dl class="py class">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe_rz.</span></span><span class="sig-name descname"><span class="pre">QPE_RZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Probability Loading</p>
<dl class="py method">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.exe">
<span class="sig-name descname"><span class="pre">exe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.exe" title="Link to this definition"></a></dt>
<dd><p>Execution of workflow</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.get_metrics">
<span class="sig-name descname"><span class="pre">get_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.get_metrics" title="Link to this definition"></a></dt>
<dd><p>Computing Metrics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.quantum_distribution">
<span class="sig-name descname"><span class="pre">quantum_distribution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.quantum_distribution" title="Link to this definition"></a></dt>
<dd><p>Computes the quantum distribution of Rz eigenvalues</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.summary" title="Link to this definition"></a></dt>
<dd><p>Pandas summary</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.theoretical_distribution">
<span class="sig-name descname"><span class="pre">theoretical_distribution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe_rz.QPE_RZ.theoretical_distribution" title="Link to this definition"></a></dt>
<dd><p>Computes the theoretical distribution of Rz eigenvalues</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe_rz.save">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe_rz.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe_rz.save" title="Link to this definition"></a></dt>
<dd><p>For saving panda DataFrames to csvs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save</strong> (<em>bool</em>) – For saving or not</p></li>
<li><p><strong>save_nam</strong> (<em>str</em>) – name for file</p></li>
<li><p><strong>input_pdf</strong> (<em>pandas DataFrame</em>)</p></li>
<li><p><strong>save_mode</strong> (<em>str</em>) – saving mode: overwrite (w) or append (a)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tnbs.BTC_03_QPE.QPE.rz_lib">
<span id="qpe-rz-lib"></span><h2>QPE.rz_lib<a class="headerlink" href="#module-tnbs.BTC_03_QPE.QPE.rz_lib" title="Link to this heading"></a></h2>
<p>All mandatory functions for executing theoretical and atos qlm
simulation for computing eigenvalues of a R_z^n operator</p>
<p>Author: Gonzalo Ferro</p>
<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_lib.bitfield">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_lib.</span></span><span class="sig-name descname"><span class="pre">bitfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_int</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_lib.bitfield" title="Link to this definition"></a></dt>
<dd><p>Transforms an int n_int to the corresponding bitfield of size size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_int</strong> (<em>int</em>) – integer from which we want to obtain the bitfield</p></li>
<li><p><strong>size</strong> (<em>int</em>) – size of the bitfield</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>full</strong> – bitfield representation of n_int with size size</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of ints</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_lib.computing_shots">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_lib.</span></span><span class="sig-name descname"><span class="pre">computing_shots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_lib.computing_shots" title="Link to this definition"></a></dt>
<dd><p>Compute the number of shots. The main idea is that the samples for
the lowest degeneracy eigenvalues will be enough. In this case
enough is that that we measured an eigenvalue that will have an
error from respect to the theoretical one lower than the
discretization precision at least 100 times</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdf</strong> (<em>pandas DataFrame</em>) – DataFrame with the theoretical eigenvalues</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>shots</strong> – number of shots for QPE algorithm</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_lib.make_histogram">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_lib.</span></span><span class="sig-name descname"><span class="pre">make_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigenvalues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discretization</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_lib.make_histogram" title="Link to this definition"></a></dt>
<dd><p>Given an input list of eigenvalues compute the correspondent
histogram using a bins = 2^discretization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigenvalues</strong> (<em>list</em>) – List with the eigenvalues</p></li>
<li><p><strong>discretization</strong> (<em>int</em>) – Histogram discretization parameter: The number of bins for the
histogram will be: 2^discretization</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pdf</strong> – Pandas Dataframe with the 2^m bin frequency histogram for the
input list of eigenvalues. Columns
* lambda : bin discretization for eigenvalues based on the
discretization input
* Probability: probability of finding any eigenvalue inside
of the correspoondent lambda bin</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_lib.qpe_rz_qlm">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_lib.</span></span><span class="sig-name descname"><span class="pre">qpe_rz_qlm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliar_qbits_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_lib.qpe_rz_qlm" title="Link to this definition"></a></dt>
<dd><p>Computes the Quantum Phase Estimation for a Rz Kronecker product</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angles</strong> (<em>list</em>) – list with the angles that are applied to each qubit of the circuit</p></li>
<li><p><strong>auxiliar_qbits_number</strong> (<em>int</em>) – number of auxiliary qubits for doing QPE</p></li>
<li><p><strong>shots</strong> (<em>int</em>) – number of shots for getting the results. 0 for exact solution</p></li>
<li><p><strong>qpu</strong> (<em>Atos QLM QPU object</em>) – QLM QPU for solving the circuit</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>pandas DataFrame</em>) – pandas DataFrame with the distribution of the eigenvalues with
a bin discretization of 2^auxiliar_qbits_number
* lambda : bin discretization for eigenvalues based on the
discretization input (auxiliar_qbits_number input)
* Probability: probability of finding any eigenvalue inside
of the correspoondent lambda bin</p></li>
<li><p><strong>qft_pe</strong> (<em>CQPE object</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_lib.rz_angles">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_lib.</span></span><span class="sig-name descname"><span class="pre">rz_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thetas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_lib.rz_angles" title="Link to this definition"></a></dt>
<dd><p>Creates a QLM abstract Gate with a R_z^n operator of an input array of angles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>thetas</strong> (<em>array</em>) – Array with the angles of the R_z^n operator</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>r_z_n</strong> – AbstractGate with the implementation of R_z_^n of the input angles</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>QLM AbstractGate</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_lib.rz_eigenv_from_state">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_lib.</span></span><span class="sig-name descname"><span class="pre">rz_eigenv_from_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_lib.rz_eigenv_from_state" title="Link to this definition"></a></dt>
<dd><p>For a fixed input state and the angles of the R_z^n operator compute
the correspondent eigenvalue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>np.array</em>) – Array with the binary representation of the input state</p></li>
<li><p><strong>angles</strong> (<em>np.array</em>) – Array with the angles for the R_z^n operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>lambda_</strong> – The eigenvalue for the input state of the R_z^n operator with
the input angles</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_lib.rz_eigv">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_lib.</span></span><span class="sig-name descname"><span class="pre">rz_eigv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_lib.rz_eigv" title="Link to this definition"></a></dt>
<dd><p>Computes the complete list of eigenvalues for a R_z^n operator
for an input list of angles
Provides the histogram between [0,1] with a bin of 2**discretization
for the distribution of eigenvalues of a R_z^n operator for a given
list of angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>angles</strong> (<em>np.array</em>) – Array with the angles for the R_z^n operator.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pdf</strong> – DataFrame with all the eigenvalues of the R_z^n operator for
the input list angles. Columns
* States : Eigenstates of the Rz^n operator (least
significant bit is leftmost)
* Int_lsb_left : Integer conversion of the state
(leftmost lsb)
* Int_lsb_rightt : Integer conversion of the state
(rightmost lsb)
* Eigenvalues : correspondent eigenvalue</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tnbs.BTC_03_QPE.QPE.rz_qlm">
<span id="qpe-rz-qlm"></span><h2>QPE.rz_qlm<a class="headerlink" href="#module-tnbs.BTC_03_QPE.QPE.rz_qlm" title="Link to this heading"></a></h2>
<p>Author: Gonzal Ferro</p>
<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_qlm.qpe_rz_qlm">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_qlm.</span></span><span class="sig-name descname"><span class="pre">qpe_rz_qlm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliar_qbits_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_qlm.qpe_rz_qlm" title="Link to this definition"></a></dt>
<dd><p>Computes the Quantum Phase Estimation for a Rz Kroneckr product</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angles</strong> (<em>list</em>) – list with the angles that are applied to each qubit of the circuit</p></li>
<li><p><strong>auxiliar_qbits_number</strong> (<em>int</em>) – number of auxiliar qubits for doing QPE</p></li>
<li><p><strong>shots</strong> (<em>int</em>) – number of shots for gettiong the results. 0 for exact solution</p></li>
<li><p><strong>qpu</strong> (<em>Atos QLM QPU object</em>) – QLM QPU for solving the circuit</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>pandas DataFrame</em>) – pandas DataFrame with the distribution of the eigenvalues with
a bin discretization of 2^auxiliar_qbits_number
* lambda : bin discretization for eigenvalues based on the
discretization input (auxiliar_qbits_number input)
* Probability: probability of finding any eigenvalue inside
of the correspoondent lambda bin</p></li>
<li><p><strong>qft_pe</strong> (<em>CQPE object</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.rz_qlm.rz_angles">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.rz_qlm.</span></span><span class="sig-name descname"><span class="pre">rz_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thetas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.rz_qlm.rz_angles" title="Link to this definition"></a></dt>
<dd><p>Creates a QLM abstract Gate with a R_z^n operator of an input array of angles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>thetas</strong> (<em>array</em>) – Array with the angles of the R_z^n operator</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>r_z_n</strong> – AbstractGate with the implementation of R_z_^n of the input angles</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>QLM AbstractGate</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tnbs.BTC_03_QPE.QPE.qpe">
<span id="qpe-qpe"></span><h2>QPE.qpe<a class="headerlink" href="#module-tnbs.BTC_03_QPE.QPE.qpe" title="Link to this heading"></a></h2>
<p>Mandatory functions for performing classical QPE
Author: Gonzal Ferro</p>
<dl class="py class">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.CQPE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe.</span></span><span class="sig-name descname"><span class="pre">CQPE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.CQPE" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for using classical Quantum Phase Estimation, with inverse of
Quantum Fourier Transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwars</strong> (<em>dictionary</em>) – <p>dictionary that allows the configuration of the CQPE algorithm: Implemented keys:</p>
<dl class="simple">
<dt>initial_state<span class="classifier">QLM Program</span></dt><dd><p>QLM Program with the initial Psi state over the
Grover-like operator will be applied
Only used if oracle is None</p>
</dd>
<dt>unitary_operator<span class="classifier">QLM gate or routine</span></dt><dd><p>Grover-like operator which autovalues want to be calculated
Only used if oracle is None</p>
</dd>
<dt>cbits_number<span class="classifier">int</span></dt><dd><p>number of classical bits for phase estimation</p>
</dd>
<dt>qpu<span class="classifier">QLM solver</span></dt><dd><p>solver for simulating the resulting circuits</p>
</dd>
<dt>shots<span class="classifier">int</span></dt><dd><p>number of shots for quantum job. If 0 exact probabilities
will be computed.</p>
</dd>
</dl>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.CQPE.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.CQPE.run" title="Link to this definition"></a></dt>
<dd><p>Creates the quantum phase estimation routine</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.check_list_type">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe.</span></span><span class="sig-name descname"><span class="pre">check_list_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tipo</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.check_list_type" title="Link to this definition"></a></dt>
<dd><p>Check if a list x_input is of type tipo
:param x_input:
:type x_input: list
:param tipo: it has to be understandable by numpy
:type tipo: data type</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y_output</strong> – numpy array of type tipo.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.create_qcircuit">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe.</span></span><span class="sig-name descname"><span class="pre">create_qcircuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prog_q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.create_qcircuit" title="Link to this definition"></a></dt>
<dd><p>Given a QLM program creates a QLM circuit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prog_q</strong> (<em>QLM QProgram</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>circuit</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>QLM circuit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.create_qjob">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe.</span></span><span class="sig-name descname"><span class="pre">create_qjob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">circuit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.create_qjob" title="Link to this definition"></a></dt>
<dd><p>Given a QLM circuit creates a QLM job</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>circuit</strong> (<em>QLM circuit</em>)</p></li>
<li><p><strong>shots</strong> (<em>int</em>) – number of measurmentes</p></li>
<li><p><strong>qubits</strong> (<em>list</em>) – with the qubits to be measured</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>job</strong> – job for submit to QLM QPU</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>QLM job</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.create_qprogram">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe.</span></span><span class="sig-name descname"><span class="pre">create_qprogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quantum_gate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.create_qprogram" title="Link to this definition"></a></dt>
<dd><p>Creates a Quantum Program from an input qlm gate or routine</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quantum_gate</strong> (<em>QLM gate</em><em> or </em><em>QLM routine</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>q_prog</strong> – Quantum Program from input QLM gate or routine</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>QLM Program.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.get_results">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe.</span></span><span class="sig-name descname"><span class="pre">get_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quantum_object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linalg_qpu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.get_results" title="Link to this definition"></a></dt>
<dd><p>Function for testing an input gate. This function creates the
quantum program for an input gate, the correspondent circuit
and job. Execute the job and gets the results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantum_object</strong> (<em>QLM Gate</em><em>, </em><em>Routine</em><em> or </em><em>Program</em>)</p></li>
<li><p><strong>linalg_qpu</strong> (<em>QLM solver</em>)</p></li>
<li><p><strong>shots</strong> (<em>int</em>) – number of shots for the generated job.
if 0 True probabilities will be computed</p></li>
<li><p><strong>qubits</strong> (<em>list</em>) – list with the qubits for doing the measurement when simulating
if None measurement over all allocated qubits will be provided</p></li>
<li><p><strong>complete</strong> (<em>bool</em>) – for return the complete basis state. Useful when shots is not 0
and all the posible basis states are necessary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pdf</strong> (<em>pandas DataFrame</em>) – DataFrame with the results of the simulation</p></li>
<li><p><strong>circuit</strong> (<em>QLM circuit</em>)</p></li>
<li><p><strong>q_prog</strong> (<em>QLM Program.</em>)</p></li>
<li><p><strong>job</strong> (<em>QLM job</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.load_qn_gate">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe.</span></span><span class="sig-name descname"><span class="pre">load_qn_gate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlm_gate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_times</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.load_qn_gate" title="Link to this definition"></a></dt>
<dd><p>Create an AbstractGate by applying an input gate n times</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qlm_gate</strong> (<em>QLM gate</em>) – QLM gate that will be applied n times</p></li>
<li><p><strong>n_times</strong> (<em>int</em>) – number of times the qlm_gate will be applied</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tnbs.BTC_03_QPE.QPE.qpe.proccess_qresults">
<span class="sig-prename descclassname"><span class="pre">tnbs.BTC_03_QPE.QPE.qpe.</span></span><span class="sig-name descname"><span class="pre">proccess_qresults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tnbs.BTC_03_QPE.QPE.qpe.proccess_qresults" title="Link to this definition"></a></dt>
<dd><p>Post Process a QLM results for creating a pandas DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>QLM results from a QLM qpu.</em>) – returned object from a qpu submit</p></li>
<li><p><strong>qubits</strong> (<em>int</em>) – number of qubits</p></li>
<li><p><strong>complete</strong> (<em>bool</em>) – for return the complete basis state.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tnbs.BTC_03_QPE.html" class="btn btn-neutral float-left" title="BTC_03_QPE: Quantum Phase Estimation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tnbs.BTC_04_PH.html" class="btn btn-neutral float-right" title="BTC_04_PH: Parent Hamiltonian" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright UDC &amp; CESGA 2021-2022.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
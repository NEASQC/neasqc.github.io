

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iterative_quantum_pe &mdash; NEASQC documentation  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
      <link rel="stylesheet" type="text/css" href="_static/contentui.css" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/contentui.js"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="QQuantLib.finance" href="finance.html" />
    <link rel="prev" title="classical_qpe" href="pe.classical_qpe.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            NEASQC documentation
              <img src="_static/logo-neasqc.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="dl.html">QQuantLib.DL</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="aa.html">QQuantLib.AA</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ae.html">QQuantLib.AE</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="pe.html">QQuantLib.PE</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pe.classical_qpe.html">classical_qpe</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">iterative_quantum_pe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE"><code class="docutils literal notranslate"><span class="pre">IQPE</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.apply_iqpe"><code class="docutils literal notranslate"><span class="pre">IQPE.apply_iqpe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.cbits_number"><code class="docutils literal notranslate"><span class="pre">IQPE.cbits_number</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.init_iqpe"><code class="docutils literal notranslate"><span class="pre">IQPE.init_iqpe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.iqpe"><code class="docutils literal notranslate"><span class="pre">IQPE.iqpe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.measure_classical_bits"><code class="docutils literal notranslate"><span class="pre">IQPE.measure_classical_bits()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.post_proccess"><code class="docutils literal notranslate"><span class="pre">IQPE.post_proccess()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.restart"><code class="docutils literal notranslate"><span class="pre">IQPE.restart()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.run_qprogram"><code class="docutils literal notranslate"><span class="pre">IQPE.run_qprogram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.step_iqpe"><code class="docutils literal notranslate"><span class="pre">IQPE.step_iqpe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.sumarize"><code class="docutils literal notranslate"><span class="pre">IQPE.sumarize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="finance.html">QQuantLib.finance</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="qml4var.html">QQuantLib.qml4var</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="qpu.html">QQuantLib.qpu</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html">QQuantLib.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NEASQC documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="pe.html">QQuantLib.PE</a></li>
      <li class="breadcrumb-item active">iterative_quantum_pe</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-QQuantLib.PE.iterative_quantum_pe">
<span id="iterative-quantum-pe"></span><h1>iterative_quantum_pe<a class="headerlink" href="#module-QQuantLib.PE.iterative_quantum_pe" title="Link to this heading"></a></h1>
<p>This module contains the necessary functions and classes to implement
Iterative Quantum Phase Estimation (IQPE).
The implementation is based on the following paper:</p>
<blockquote>
<div><p><em>Dobšíček, Miroslav and Johansson, Göran and Shumeiko, Vitaly and
Wendin, Göran</em>.
Arbitrary accuracy iterative quantum phase estimation algorithm
using a single ancillary qubit: A two-qubit benchmark.
Physical Review A 3(76), 2007.
<a class="reference external" href="https://arxiv.org/abs/quant-ph/0610214*">https://arxiv.org/abs/quant-ph/0610214*</a></p>
</div></blockquote>
<p>Author: Gonzalo Ferro Costas &amp; Alberto Manzano Herrero</p>
<dl class="py class">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">QQuantLib.PE.iterative_quantum_pe.</span></span><span class="sig-name descname"><span class="pre">IQPE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE" title="Link to this definition"></a></dt>
<dd><p>Class for using Iterative Quantum Phase Estimation (IQPE) algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwars</strong> (<em>dictionary</em>) – <p>dictionary that allows the configuration of the ML-QPE algorithm. Implemented keys:</p>
<dl class="simple">
<dt>initial_state<span class="classifier">QLM Program</span></dt><dd><p>QLM Program withe the initial Psi state over the
Grover-like operator will be applied
Only used if oracle is None</p>
</dd>
<dt>unitary_operator<span class="classifier">QLM gate or routine</span></dt><dd><p>Grover-like operator whose autovalues want to be calculated
Only used if oracle is None</p>
</dd>
<dt>cbits_number<span class="classifier">int</span></dt><dd><p>number of classical bits for phase estimation</p>
</dd>
<dt>qpu<span class="classifier">QLM solver</span></dt><dd><p>solver for simulating the resulting circuits</p>
</dd>
<dt>shots<span class="classifier">int</span></dt><dd><p>number of shots for quantum job. If 0 exact probabilities
will be computed.</p>
</dd>
<dt>easy<span class="classifier">bool</span></dt><dd><p>If True step_iqpe_easy will be used for each step of the
algorithm
If False step_iqpe will be used for each step.</p>
</dd>
</dl>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.apply_iqpe">
<span class="sig-name descname"><span class="pre">apply_iqpe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.apply_iqpe" title="Link to this definition"></a></dt>
<dd><p>Apply a complete IQPE algorithm</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.cbits_number">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cbits_number</span></span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.cbits_number" title="Link to this definition"></a></dt>
<dd><p>creating cbits_number property</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.init_iqpe">
<span class="sig-name descname"><span class="pre">init_iqpe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.init_iqpe" title="Link to this definition"></a></dt>
<dd><p>Initialize several properties</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.iqpe">
<span class="sig-name descname"><span class="pre">iqpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number_of_cbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.iqpe" title="Link to this definition"></a></dt>
<dd><p>This method apply a workflow for executing a complete IQPE
algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number_of_cbits</strong> (<em>int</em><em> (</em><em>overwrite correspondent property</em><em>)</em>) – Number of classical bits for storing the phase estimation</p></li>
<li><p><strong>shots</strong> (<em>int</em><em> (</em><em>overwrite correspondent property</em><em>)</em>) – Number of shots for executing the QLM job</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.measure_classical_bits">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">measure_classical_bits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.measure_classical_bits" title="Link to this definition"></a></dt>
<dd><p>Post-process intermediate measurements from a QLM result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>result</strong> (<em>list list with QLM results</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>pdf</strong> – contains extracted information from intermediate_measurements from a qlm result. Columns:</p>
<dl class="simple">
<dt>BitString<span class="classifier">str.</span></dt><dd><p>String with the bits of the measurements done during
simulation of the circuit</p>
</dd>
<dt>BitInt<span class="classifier">int.</span></dt><dd><p>Integer representation of the BitString</p>
</dd>
<dt>Phi<span class="classifier">float.</span></dt><dd><p>Angle representation of the BitString between [0,1].</p>
</dd>
<dt>Probability<span class="classifier">float.</span></dt><dd><p>Probability of the measurement of the classical bits.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.post_proccess">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">post_proccess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_pdf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.post_proccess" title="Link to this definition"></a></dt>
<dd><p>This function uses the results property and add it additional
columns that are useful for Amplitude Amplification procedure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_pdf</strong> (<em>Pandas DataFrame.</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>final_results</strong> – DataFrame with complete information about the results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.restart">
<span class="sig-name descname"><span class="pre">restart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.restart" title="Link to this definition"></a></dt>
<dd><p>Reinitialize several properties for restart purposes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.run_qprogram">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_qprogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_prog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_aux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linalg_qpu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.run_qprogram" title="Link to this definition"></a></dt>
<dd><p>Executes a complete simulation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_prog</strong> (<em>QLM Program</em>)</p></li>
<li><p><strong>q_aux</strong> (<em>QLM qbit</em>) – auxiliary qubit for measuring during all ipe steps</p></li>
<li><p><strong>shots</strong> (<em>int</em>) – number of shots for simulation</p></li>
<li><p><strong>linalg_qpu</strong> (<em>QLM solver</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result</strong> (<em>QLM result object</em>)</p></li>
<li><p><strong>circuit</strong> (<em>QLM circuit</em>)</p></li>
<li><p><strong>pdf_time</strong> (<em>pandas DataFrame</em>) – DataFrame with elapsed time of different parts of the simulation</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.step_iqpe">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step_iqpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_prog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_gate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_aux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_bits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.step_iqpe" title="Link to this definition"></a></dt>
<dd><p>Implements a iterative step of the Iterative Phase Estimation (IPE)
algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_prog</strong> (<em>QLM program</em>) – QLM Program where the unitary operator will be applied</p></li>
<li><p><strong>q_gate</strong> (<em>QLM AbstractGate</em>) – QLM implementation of the unitary operator. We want estimate
the autovalue theta of this operator</p></li>
<li><p><strong>q_aux</strong> (<em>QLM qbit</em>) – auxiliary qubit for IPE. This qbit will be the control
for application of the unitary operator to the principal bits
of the program. Additionally will be the target qubit for the
classical bit controlled rotation. This qubit will be reset at
the end of the step.</p></li>
<li><p><strong>c_bits</strong> (<em>list</em>) – list with the classical bits allocated for phase estimation</p></li>
<li><p><strong>l</strong> (<em>int</em>) – iteration step of the IPE algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="QQuantLib.PE.iterative_quantum_pe.IQPE.sumarize">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sumarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.sumarize" title="Link to this definition"></a></dt>
<dd><p>This method summarize the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_pdf</strong> (<em>Pandas DataFrame.</em>)</p></li>
<li><p><strong>columns</strong> (<em>list</em>) – list with the names of the input DataFrame for summarize</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>final_results</strong> – DataFrame with summary results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pe.classical_qpe.html" class="btn btn-neutral float-left" title="classical_qpe" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="finance.html" class="btn btn-neutral float-right" title="QQuantLib.finance" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright UDC &amp; CESGA 2021-2022.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
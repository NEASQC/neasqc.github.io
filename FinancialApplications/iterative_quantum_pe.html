<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iterative_quantum_pe &mdash; NEASQC documentation  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="_static/contentui.css" type="text/css" /><link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/contentui.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="classical_qpe" href="classical_qpe.html" />
    <link rel="prev" title="QQuantLib.PE" href="pe.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> NEASQC documentation<img src="_static/logo-neasqc.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dl.html">QQuantLib.DL</a></li>
<li class="toctree-l1"><a class="reference internal" href="aa.html">QQuantLib.AA</a></li>
<li class="toctree-l1"><a class="reference internal" href="ae.html">QQuantLib.AE</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="pe.html">QQuantLib.PE</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">iterative_quantum_pe</a></li>
<li class="toctree-l2"><a class="reference internal" href="classical_qpe.html">classical_qpe</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="finance.html">QQuantLib.finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">QQuantLib.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NEASQC documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="pe.html">QQuantLib.PE</a> &raquo;</li>
      <li>iterative_quantum_pe</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-QQuantLib.PE.iterative_quantum_pe">
<span id="iterative-quantum-pe"></span><h1>iterative_quantum_pe<a class="headerlink" href="#module-QQuantLib.PE.iterative_quantum_pe" title="Permalink to this headline">¶</a></h1>
<p>This module contains necesary functions and classes to implement
Iterative Quantum Phase Estimation (IQPE). The implementation is based on
following paper:</p>
<blockquote>
<div><p>Dobšíček, Miroslav and Johansson, Göran and Shumeiko, Vitaly and
Wendin, Göran*.
Arbitrary accuracy iterative quantum phase estimation algorithm
using a single ancillary qubit: A two-qubit benchmark.
Physical Review A 3(76), 2007.
<a class="reference external" href="https://arxiv.org/abs/quant-ph/0610214">https://arxiv.org/abs/quant-ph/0610214</a></p>
</div></blockquote>
<p>Author: Gonzalo Ferro Costas &amp; Alberto Manzano Herrero</p>
<dl class="class">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE">
<em class="property">class </em><code class="sig-prename descclassname">QQuantLib.PE.iterative_quantum_pe.</code><code class="sig-name descname">IQPE</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for using Iterative Quantum Phase Estimation (IQPE) algorithm</p>
<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.apply_iqpe">
<code class="sig-name descname">apply_iqpe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.apply_iqpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a complete IQPE algorithm</p>
</dd></dl>

<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.cbits_number">
<em class="property">property </em><code class="sig-name descname">cbits_number</code><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.cbits_number" title="Permalink to this definition">¶</a></dt>
<dd><p>creating cbits_number property</p>
</dd></dl>

<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.init_iqpe">
<code class="sig-name descname">init_iqpe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.init_iqpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize several properties</p>
</dd></dl>

<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.iqpe">
<code class="sig-name descname">iqpe</code><span class="sig-paren">(</span><em class="sig-param">number_of_cbits=None</em>, <em class="sig-param">shots=None</em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.iqpe" title="Permalink to this definition">¶</a></dt>
<dd><p>This method apply a workflow for executing a complete IQPE
algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number_of_cbits</strong> (<em>int</em><em> (</em><em>overwrite correspondient property</em><em>)</em>) – Number of classical bits for storing the phase estimation</p></li>
<li><p><strong>shots</strong> (<em>int</em><em> (</em><em>overwrite correspondient property</em><em>)</em>) – Number of shots for executing the QLM job</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.measure_classical_bits">
<em class="property">static </em><code class="sig-name descname">measure_classical_bits</code><span class="sig-paren">(</span><em class="sig-param">result</em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.measure_classical_bits" title="Permalink to this definition">¶</a></dt>
<dd><p>Post Proccess intermediate measurements from a qlm result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>result</strong> (<em>list list with qlm results</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pdf</strong> (<em>pandas DataFrame</em>)</p></li>
<li><p><em>contains extracted information from intermediate_measurements</em></p></li>
<li><p><em>from a qlm result. Columns</em></p></li>
<li><p><strong>BitString</strong> (<em>str. String with the bits of the measurements done</em>)</p></li>
<li><p><em>during simulation of the circuit</em></p></li>
<li><p><strong>BitInt</strong> (<em>int. Integer representation of the BitString</em>)</p></li>
<li><p><strong>Phi</strong> (<em>float. Angle representation of the BitString between [0,1].</em>)</p></li>
<li><p><strong>Probability</strong> (<em>float. Probability of the measurement of the classsical bits.</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.post_proccess">
<em class="property">static </em><code class="sig-name descname">post_proccess</code><span class="sig-paren">(</span><em class="sig-param">input_pdf</em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.post_proccess" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the results property and add it additional
columns that are useful for Amplitude Amplification procedure</p>
</dd></dl>

<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.restart">
<code class="sig-name descname">restart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.restart" title="Permalink to this definition">¶</a></dt>
<dd><p>Reinitialize several properties for restart purpouses</p>
</dd></dl>

<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.run_qprogram">
<em class="property">static </em><code class="sig-name descname">run_qprogram</code><span class="sig-paren">(</span><em class="sig-param">q_prog</em>, <em class="sig-param">q_aux</em>, <em class="sig-param">shots</em>, <em class="sig-param">linalg_qpu</em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.run_qprogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a complete simulation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_prog</strong> (<em>QLM Program</em>) – </p></li>
<li><p><strong>q_aux</strong> (<em>QLM qbit</em>) – auxiliar qbit for measuring during all ipe steps</p></li>
<li><p><strong>shots</strong> (<em>int</em>) – number of shots for simulation</p></li>
<li><p><strong>linalg_qpu</strong> (<em>QLM solver</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result</strong> (<em>QLM result object</em>)</p></li>
<li><p><strong>circuit</strong> (<em>QLM circuit</em>)</p></li>
<li><p><strong>pdf_time</strong> (<em>pandas DataFrame</em>) – DataFrame with elapsed time of different parts of the simulation</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="QQuantLib.PE.iterative_quantum_pe.IQPE.step_iqpe">
<em class="property">static </em><code class="sig-name descname">step_iqpe</code><span class="sig-paren">(</span><em class="sig-param">q_prog</em>, <em class="sig-param">q_gate</em>, <em class="sig-param">q_aux</em>, <em class="sig-param">c_bits</em>, <em class="sig-param">l</em><span class="sig-paren">)</span><a class="headerlink" href="#QQuantLib.PE.iterative_quantum_pe.IQPE.step_iqpe" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements a iterative step of the Iterative Phase Estimation (IPE)
algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_prog</strong> (<em>QLM program</em>) – QLM Program where the unitary operator will be applied</p></li>
<li><p><strong>q_gate</strong> (<em>QLM AbstractGate</em>) – QLM implementation of the unitary operator. We want estimate
the autovalue theta of this operator</p></li>
<li><p><strong>q_aux</strong> (<em>QLM qbit</em>) – auxiliar qbit for IPE. This qbit will be the control
for application of the unitary operator to the principal qbits
of the program. Aditionally will be the target qbit for the
classical bit controlled rotation. This qbit will be reset at
the end of the step.</p></li>
<li><p><strong>c_bits</strong> (<em>list</em>) – list with the classical bits allocated for phase estimation</p></li>
<li><p><strong>l</strong> (<em>int</em>) – iteration step of the IPE algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pe.html" class="btn btn-neutral float-left" title="QQuantLib.PE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="classical_qpe.html" class="btn btn-neutral float-right" title="classical_qpe" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright UDC &amp; CESGA 2021-2022.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>